TEMPLATES
"
{
    ""source_queries"":{
    ""fivetran"":
        {
            ""facebook"":
            {
                ""dim_account"":
                    ""select ID, NAME, ACCOUNT_STATUS, BUSINESS_COUNTRY_CODE, CURRENCY, TIMEZONE_NAME, TO_TIMESTAMP_NTZ(CREATED_TIME), NULL, NULL FROM DATABASE.SCHEMA.ACCOUNT_HISTORY qualify row_number() over (partition by id order by _fivetran_synced desc) = 1"",
                ""dim_campaign"":
                    ""SELECT ID,NAME, ACCOUNT_ID, TO_TIMESTAMP_NTZ(START_TIME),TO_TIMESTAMP_NTZ(STOP_TIME), STATUS, DAILY_BUDGET, LIFETIME_BUDGET, BUDGET_REMAINING, TO_TIMESTAMP_NTZ(CREATED_TIME), TO_TIMESTAMP_NTZ(UPDATED_TIME)  FROM DATABASE.SCHEMA.CAMPAIGN_HISTORY qualify row_number() over (partition by id order by TO_TIMESTAMP_NTZ(UPDATED_TIME) desc) = 1"",
                ""dim_ad_group"":
                    ""SELECT ID, NAME, CAMPAIGN_ID,ACCOUNT_ID ,TO_TIMESTAMP_NTZ(CREATED_TIME), TO_TIMESTAMP_NTZ(UPDATED_TIME)  FROM DATABASE.SCHEMA.AD_SET_HISTORY qualify  row_number() over (partition by id order by TO_TIMESTAMP_NTZ(UPDATED_TIME) desc) = 1"",
                ""metrics"":
                    ""SELECT AD.AD_ID, AD.DATE, ACCOUNT.TIMEZONE_NAME, NULL, P.PLATFORM_ID, AD.ACCOUNT_ID, AD_HISTORY.CAMPAIGN_ID, AD_HISTORY.AD_SET_ID, NULL, NULL, ACCOUNT.CURRENCY, AD.IMPRESSIONS, AD.INLINE_LINK_CLICKS, AD.SPEND FROM DATABASE.SCHEMA.BASIC_AD AD LEFT JOIN (select TIMEZONE_NAME, CURRENCY, ID FROM DATABASE.SCHEMA.ACCOUNT_HISTORY qualify row_number() over (partition by id order by _fivetran_synced desc) = 1) ACCOUNT ON ACCOUNT.ID = AD.ACCOUNT_ID LEFT JOIN (select ID,AD_SET_ID, CAMPAIGN_ID from DATABASE.SCHEMA.AD_HISTORY qualify row_number() over (partition by id order by TO_TIMESTAMP_NTZ(UPDATED_TIME) desc) = 1) AD_HISTORY ON AD_HISTORY.ID = AD.AD_ID LEFT JOIN APPLICATION.CAMPAIGN_INTELLIGENCE_COMBINED.DIM_PLATFORM P ON P.PLATFORM_NAME = 'facebook'""


                
            }
            },
    ""omnata"":
        {
            ""linkedin"":
            {
                ""dim_account"":
                    ""select APP_IDENTIFIER,REPLACE(RECORD_DATA['name'],'\""',''), REPLACE(RECORD_DATA['status'],'\""',''),NULL,REPLACE(RECORD_DATA['currency'],'\""',''),NULL,TO_TIMESTAMP(RECORD_DATA['changeAuditStamps']['created']['time']::varchar),TO_TIMESTAMP(RECORD_DATA['changeAuditStamps']['lastModified']['time']::varchar), NULL  from DATABASE.SCHEMA.ACCOUNTS"",
                ""dim_campaign"":
                    ""select REPLACE(RECORD_DATA['campaign_group_id'],'\""','') AS CAMPAIGN_GROUP_ID, CONCAT('Campaign_', REPLACE(RECORD_DATA['campaign_group_id'],'\""','')),ACCOUNTS.ACCOUNT_ID,MIN(REPLACE(RECORD_DATA['start_date'], '\""','')), MAX(REPLACE(RECORD_DATA['end_date'], '\""','')),CAMPAIGNS.STATUS,DAILY_BUDGET,NULL, NULL,NULL,NULL FROM  DATABASE.SCHEMA.ad_analytics_by_campaign_group_daily  CAMPAIGN LEFT JOIN ( SELECT SPLIT_PART(RECORD_DATA['account'],':',4) AS ACCOUNT_ID,SPLIT_PART(RECORD_DATA['campaignGroup'],':',4) AS CAMPAIGN_GROUP_ID, replace(RECORD_DATA['status'],'\""','') as STATUS ,SUM(REPLACE(RECORD_DATA['dailyBudget']['amount'],'\""')) AS DAILY_BUDGET FROM  DATABASE.SCHEMA.campaigns GROUP BY 1,2,3) CAMPAIGNS ON CAMPAIGNS.CAMPAIGN_GROUP_ID = REPLACE(RECORD_DATA['campaign_group_id'],'\""','') LEFT JOIN (SELECT RECORD_DATA['name'] as account_name, RECORD_DATA['id'] as account_id from  DATABASE.SCHEMA.accounts) ACCOUNTS ON ACCOUNTS.ACCOUNT_ID = CAMPAIGNS.ACCOUNT_ID group by 1,2,3,7,6,9,10"",
                ""dim_ad_group"":
                    ""SELECT APP_IDENTIFIER,REPLACE(RECORD_DATA['name'],'',''), SPLIT_PART(RECORD_DATA['campaignGroup'],':',4), SPLIT_PART(RECORD_DATA['account'],':',4), TO_TIMESTAMP(RECORD_DATA['changeAuditStamps']['created']['time']::VARCHAR), TO_TIMESTAMP(RECORD_DATA['changeAuditStamps']['lastModified']['time']::VARCHAR)  FROM DATABASE.SCHEMA.campaigns"",
                ""metrics"":
                    ""SELECT NULL,TO_DATE(REPLACE(RECORD_DATA['start_date'],'\""','')), NULL, NULL, P.PLATFORM_ID,CAMPAIGNS.ACCOUNT_ID, CAMPAIGNS.CAMPAIGN_GROUP_ID,REPLACE(RECORD_DATA['campaign_id'],'\""','') AS CAMPAIGN_ID, NULL, NULL, CAMPAIGNS.CURRENCY, RECORD_DATA['impressions'],RECORD_DATA['clicks'], REPLACE(RECORD_DATA['costInLocalCurrency'],'\""',''), FROM DATABASE.SCHEMA.ad_analytics_by_campaign_daily CAMPAIGNS_DAILY LEFT JOIN ( SELECT APP_IDENTIFIER, REPLACE(RECORD_DATA['name'],'\""',''), SPLIT_PART(RECORD_DATA['campaignGroup'],':',4) AS CAMPAIGN_GROUP_ID, SPLIT_PART(RECORD_DATA['account'],':',4) AS ACCOUNT_ID, REPLACE(RECORD_DATA['dailyBudget']['currencyCode'],'\""','') AS CURRENCY FROM DATABASE.SCHEMA.campaigns) CAMPAIGNS ON CAMPAIGNS.APP_IDENTIFIER = REPLACE(RECORD_DATA['campaign_id'],'\""','') LEFT JOIN APPLICATION.CAMPAIGN_INTELLIGENCE_COMBINED.DIM_PLATFORM P ON P.PLATFORM_NAME = 'linkedin'""

                    
            }
        }
    },
    ""HEADER_DYNAMIC_TABLE"":""CREATE OR REPLACE DYNAMIC TABLE CAMPAIGN_INTELLIGENCE_COMBINED.TABLE_NAME(COLUMNS_DEFINITION)\nTARGET_LAG = '1 minute'\nINITIALIZE= ON_CREATE\nWAREHOUSE = DATA_HARMONIZATION_WH\nCOMMENT=TAGGING_COMMENT\nAS\n"",
    ""AGGREGATED_REPORTS"":{
          ""CAMPAIGN_PERFORMANCE"": ""CREATE OR REPLACE DYNAMIC TABLE AGGREGATED_REPORTS.CAMPAIGN_PERFORMANCE ( AD_GROUP_ID, PLATFORM_ID, CAMPAIGN_ID, DATE, IMPRESSIONS, CLICKS, SPEND, CURRENCY_KEY, TIMEZONE, ACCOUNT_NAME, ACCOUNT_STATUS, ACCOUNT_CREATED_AT, ACCOUNT_UPDATED_AT, BUSINESS_COUNTRY_CODE, PLATFORM_NAME, AD_GROUP_NAME, CAMPAIGN_NAME, DATE_START_CAMPAIGN, DATE_END_CAMPAIGN, CAMPAIGN_STATUS, DAILY_BUDGET, LIFETIME_BUDGET, BUDGET_REMAINING, CAMPAIGN_CREATED_AT ) TARGET_LAG = DOWNSTREAM INITIALIZE = ON_CREATE WAREHOUSE = DATA_HARMONIZATION_WH COMMENT = TAGGING_COMMENT AS SELECT M.*, C.CAMPAIGN_NAME, C.DATE_START AS DATE_START_CAMPAIGN, C.DATE_END AS DATE_END_CAMPAIGN, C.STATUS AS CAMPAIGN_STATUS, C.DAILY_BUDGET, C.LIFETIME_BUDGET, C.BUDGET_REMAINING, C.CREATED_AT AS CAMPAIGN_CREATED_AT FROM ( SELECT M.*, G.AD_GROUP_NAME FROM ( SELECT M.*, P.PLATFORM_NAME FROM ( SELECT M.AD_GROUP_ID, M.PLATFORM_ID, M.CAMPAIGN_ID, M.DATE, M.IMPRESSIONS, M.CLICKS, M.SPEND, M.CURRENCY_KEY, M.TIMEZONE, A.ACCOUNT_NAME, A.ACCOUNT_STATUS, A.CREATED_AT AS ACCOUNT_CREATED_AT, A.UPDATED_AT AS ACCOUNT_UPDATED_AT, A.BUSINESS_COUNTRY_CODE FROM CAMPAIGN_INTELLIGENCE_COMBINED.METRICS AS M LEFT JOIN CAMPAIGN_INTELLIGENCE_COMBINED.DIM_ACCOUNT AS A ON M.ACCOUNT_ID = A.ACCOUNT_ID ) AS M LEFT JOIN CAMPAIGN_INTELLIGENCE_COMBINED.DIM_PLATFORM AS P ON M.PLATFORM_ID = P.PLATFORM_ID ) AS M LEFT JOIN CAMPAIGN_INTELLIGENCE_COMBINED.DIM_AD_GROUP AS G ON M.AD_GROUP_ID = G.ID ) AS M LEFT JOIN CAMPAIGN_INTELLIGENCE_COMBINED.DIM_CAMPAIGN AS C ON M.CAMPAIGN_ID = C.ID"",
              ""CAMPAIGN_REPORT_MODEL"": ""CREATE OR REPLACE DYNAMIC TABLE AGGREGATED_REPORTS.CAMPAIGN_REPORT_MODEL(CAMPAIGN_ID, PLATFORM_ID, ACCOUNT_ID, DATE, IMPRESSIONS, CLICKS, SPEND)\nTARGET_LAG = DOWNSTREAM\nINITIALIZE= ON_CREATE\nWAREHOUSE = DATA_HARMONIZATION_WH\nCOMMENT=TAGGING_COMMENT\n AS SELECT campaign_id, platform_id, account_id, date, sum(impressions), sum(clicks),  sum(spend) from CAMPAIGN_INTELLIGENCE_COMBINED.METRICS GROUP BY 1,2,3,4"", ""AD_GROUP_REPORT_MODEL"": ""CREATE OR REPLACE DYNAMIC TABLE AGGREGATED_REPORTS.AD_GROUP_REPORT_MODEL(AD_GROUP_ID, PLATFORM_ID, ACCOUNT_ID, DATE, IMPRESSIONS, CLICKS, SPEND)\nTARGET_LAG = DOWNSTREAM\nINITIALIZE= ON_CREATE\nWAREHOUSE = DATA_HARMONIZATION_WH\nCOMMENT=TAGGING_COMMENT\n  AS SELECT ad_group_id, platform_id, account_id, date, sum(impressions), sum(clicks),  sum(spend) from CAMPAIGN_INTELLIGENCE_COMBINED.METRICS GROUP BY 1,2,3,4"",""PLATFORM_REPORT_MODEL"": ""CREATE OR REPLACE DYNAMIC TABLE AGGREGATED_REPORTS.PLATFORM_REPORT_MODEL(PLATFORM_ID, DATE, IMPRESSIONS, CLICKS, SPEND)\nTARGET_LAG = DOWNSTREAM\nINITIALIZE= ON_CREATE\nWAREHOUSE = DATA_HARMONIZATION_WH\nCOMMENT=TAGGING_COMMENT\n  AS SELECT platform_id, date, sum(impressions), sum(clicks),  sum(spend) from CAMPAIGN_INTELLIGENCE_COMBINED.METRICS GROUP BY 1,2"",""ACCOUNT_REPORT_MODEL"": ""CREATE OR REPLACE DYNAMIC TABLE AGGREGATED_REPORTS.ACCOUNT_REPORT_MODEL(ACCOUNT_ID, DATE, IMPRESSIONS, CLICKS, SPEND)\nTARGET_LAG = DOWNSTREAM\nINITIALIZE= ON_CREATE\nWAREHOUSE = DATA_HARMONIZATION_WH\nCOMMENT=TAGGING_COMMENT\n  AS SELECT platform_id, date, sum(impressions), sum(clicks),  sum(spend) from CAMPAIGN_INTELLIGENCE_COMBINED.METRICS GROUP BY 1,2""},
    ""STANDARDIZE_MODEL"": {
             ""FACEBOOK"": {
             ""FACEBOOK_DIM_ACCOUNT"":""CREATE OR REPLACE DYNAMIC TABLE STANDARDIZE_MODEL.FACEBOOK_DIM_ACCOUNT(ACCOUNT_ID, ACCOUNT_NAME, ACCOUNT_STATUS, BUSINESS_COUNTRY_CODE, CURRENCY_KEY, TIMEZONE_KEY, CREATED_AT, UPDATED_AT, STATUS)\nlag = '1 minute'\ninitialize = ON_CREATE\nwarehouse = DATA_HARMONIZATION_WH\nCOMMENT=TAGGING_COMMENT\nAS\nselect ID, NAME, ACCOUNT_STATUS, BUSINESS_COUNTRY_CODE, CURRENCY, TIMEZONE_NAME, TO_TIMESTAMP_NTZ(CREATED_TIME), NULL, NULL FROM DATABASE.SCHEMA.ACCOUNT_HISTORY qualify row_number() over (partition by id order by _fivetran_synced desc) = 1"",
             ""FACEBOOK_METRICS"" :""CREATE OR REPLACE DYNAMIC TABLE STANDARDIZE_MODEL.FACEBOOK_METRICS(ad_id, date, timezone, geography_object, platform_id, account_id, campaign_id, ad_group_id, keyword_id, label_id, currency_key, impressions, clicks, spend, reach, frequency)\nTARGET_LAG = '1 minute'\nINITIALIZE= ON_CREATE\nWAREHOUSE = DATA_HARMONIZATION_WH\nCOMMENT=TAGGING_COMMENT\n AS SELECT AD.AD_ID, AD.DATE, ACCOUNT.TIMEZONE_NAME, NULL, P.PLATFORM_ID, AD.ACCOUNT_ID, AD_HISTORY.CAMPAIGN_ID, AD_HISTORY.AD_SET_ID, NULL, NULL, ACCOUNT.CURRENCY, AD.IMPRESSIONS, AD.INLINE_LINK_CLICKS, AD.SPEND, AD.REACH,AD.FREQUENCY FROM DATABASE.SCHEMA.BASIC_AD AD LEFT JOIN (select TIMEZONE_NAME, CURRENCY, ID FROM DATABASE.SCHEMA.ACCOUNT_HISTORY qualify row_number() over (partition by id order by _fivetran_synced desc) = 1) ACCOUNT ON ACCOUNT.ID = AD.ACCOUNT_ID LEFT JOIN (select ID,AD_SET_ID, CAMPAIGN_ID from DATABASE.SCHEMA.AD_HISTORY qualify row_number() over (partition by id order by TO_TIMESTAMP_NTZ(UPDATED_TIME) desc) = 1) AD_HISTORY ON AD_HISTORY.ID = AD.AD_ID LEFT JOIN CAMPAIGN_INTELLIGENCE_COMBINED.DIM_PLATFORM P ON P.PLATFORM_NAME = 'facebook' qualify row_number() over (partition by AD.AD_ID order by _fivetran_synced desc) = 1"",
             ""FACEBOOK_DIM_AD_GROUP"":""CREATE OR REPLACE DYNAMIC TABLE STANDARDIZE_MODEL.FACEBOOK_DIM_AD_GROUP( ID, AD_GROUP_NAME, CAMPAIGN_ID, ACCOUNT_ID, CREATED_AT, UPDATED_AT)\nlag = '1 minute'\ninitialize = ON_CREATE warehouse = DATA_HARMONIZATION_WH\nCOMMENT=TAGGING_COMMENT\nAS\nSELECT ID, NAME, CAMPAIGN_ID,ACCOUNT_ID ,TO_TIMESTAMP_NTZ(CREATED_TIME), TO_TIMESTAMP_NTZ(UPDATED_TIME)  FROM DATABASE.SCHEMA.AD_SET_HISTORY qualify  row_number() over (partition by id order by TO_TIMESTAMP_NTZ(UPDATED_TIME) desc) = 1"",
             ""FACEBOOK_DIM_CAMPAIGN"" : ""CREATE OR REPLACE DYNAMIC TABLE STANDARDIZE_MODEL.FACEBOOK_DIM_CAMPAIGN( ID, CAMPAIGN_NAME, ACCOUNT_ID, DATE_START, DATE_END, STATUS, DAILY_BUDGET, LIFETIME_BUDGET, BUDGET_REMAINING, CREATED_AT, UPDATED_AT)\nlag = '1 minute'\ninitialize = ON_CREATE\nwarehouse = DATA_HARMONIZATION_WH\nCOMMENT=TAGGING_COMMENT\nas\nSELECT ID,NAME, ACCOUNT_ID, TO_TIMESTAMP_NTZ(START_TIME),TO_TIMESTAMP_NTZ(STOP_TIME), STATUS, DAILY_BUDGET, LIFETIME_BUDGET, BUDGET_REMAINING, TO_TIMESTAMP_NTZ(CREATED_TIME), TO_TIMESTAMP_NTZ(UPDATED_TIME)  FROM DATABASE.SCHEMA.CAMPAIGN_HISTORY qualify row_number() over (partition by id order by TO_TIMESTAMP_NTZ(UPDATED_TIME) desc) = 1""
             },
             ""LINKEDIN"":{
             ""LINKEDIN_DIM_ACCOUNT"" :""CREATE OR REPLACE DYNAMIC TABLE STANDARDIZE_MODEL.LINKEDIN_DIM_ACCOUNT(ACCOUNT_ID, ACCOUNT_NAME, ACCOUNT_STATUS, BUSINESS_COUNTRY_CODE, CURRENCY_KEY, TIMEZONE_KEY, CREATED_AT, UPDATED_AT, STATUS)\nlag = '1 minute'\ninitialize = ON_CREATE\nwarehouse = DATA_HARMONIZATION_WH\nCOMMENT=TAGGING_COMMENT\nAS\nselect APP_IDENTIFIER,REPLACE(RECORD_DATA['name'],'\""',''), REPLACE(RECORD_DATA['status'],'\""',''),NULL,REPLACE(RECORD_DATA['currency'],'\""',''),NULL,TO_TIMESTAMP(RECORD_DATA['changeAuditStamps']['created']['time']::varchar),TO_TIMESTAMP(RECORD_DATA['changeAuditStamps']['lastModified']['time']::varchar), NULL from DATABASE.SCHEMA.accounts"",
             ""LINKEDIN_DIM_AD_GROUP"": ""CREATE OR REPLACE DYNAMIC TABLE STANDARDIZE_MODEL.LINKEDIN_DIM_AD_GROUP( ID, AD_GROUP_NAME, CAMPAIGN_ID, ACCOUNT_ID, CREATED_AT, UPDATED_AT) lag = '1 minute'\ninitialize = ON_CREATE\nwarehouse = DATA_HARMONIZATION_WH\nCOMMENT=TAGGING_COMMENT\nAS\nSELECT APP_IDENTIFIER,REPLACE(RECORD_DATA['name'],'',''), SPLIT_PART(RECORD_DATA['campaignGroup'],':',4), SPLIT_PART(RECORD_DATA['account'],':',4), TO_TIMESTAMP(RECORD_DATA['changeAuditStamps']['created']['time']::VARCHAR), TO_TIMESTAMP(RECORD_DATA['changeAuditStamps']['lastModified']['time']::VARCHAR)  FROM DATABASE.SCHEMA.campaigns"",
             ""LINKEDIN_DIM_CAMPAIGN"":""CREATE OR REPLACE DYNAMIC TABLE STANDARDIZE_MODEL.LINKEDIN_DIM_CAMPAIGN(ID,CAMPAIGN_NAME,ACCOUNT_ID,DATE_START,DATE_END,STATUS,DAILY_BUDGET,LIFETIME_BUDGET,BUDGET_REMAINING,CREATED_AT,UPDATED_AT)\nlag = '1 minute'\ninitialize = ON_CREATE\nwarehouse = DATA_HARMONIZATION_WH\nCOMMENT=TAGGING_COMMENT\nas\nselect REPLACE(RECORD_DATA['campaign_group_id'],'\""','') AS CAMPAIGN_GROUP_ID, CONCAT('Campaign_', REPLACE(RECORD_DATA['campaign_group_id'],'\""','')),ACCOUNTS.ACCOUNT_ID,MIN(REPLACE(RECORD_DATA['start_date'], '\""','')), MAX(REPLACE(RECORD_DATA['end_date'], '\""','')),CAMPAIGNS.STATUS,DAILY_BUDGET,NULL, NULL,NULL,NULL FROM  DATABASE.SCHEMA.ad_analytics_by_campaign_group_daily  CAMPAIGN LEFT JOIN ( SELECT SPLIT_PART(RECORD_DATA['account'],':',4) AS ACCOUNT_ID,SPLIT_PART(RECORD_DATA['campaignGroup'],':',4) AS CAMPAIGN_GROUP_ID, replace(RECORD_DATA['status'],'\""','') as STATUS ,SUM(REPLACE(RECORD_DATA['dailyBudget']['amount'],'\""')) AS DAILY_BUDGET FROM  DATABASE.SCHEMA.campaigns GROUP BY 1,2,3) CAMPAIGNS ON CAMPAIGNS.CAMPAIGN_GROUP_ID = REPLACE(RECORD_DATA['campaign_group_id'],'\""','') LEFT JOIN (SELECT RECORD_DATA['name'] as account_name, RECORD_DATA['id'] as account_id from  DATABASE.SCHEMA.accounts) ACCOUNTS ON ACCOUNTS.ACCOUNT_ID = CAMPAIGNS.ACCOUNT_ID group by 1,3,7,6,9,10"",
             ""LINKEDIN_METRICS"":""CREATE OR REPLACE DYNAMIC TABLE STANDARDIZE_MODEL.LINKEDIN_METRICS(AD_ID,DATE,TIMEZONE,GEOGRAPHY_OBJECT,PLATFORM_ID,ACCOUNT_ID,CAMPAIGN_ID,AD_GROUP_ID,KEYWORD_ID,LABEL_ID,CURRENCY_KEY,IMPRESSIONS,CLICKS,SPEND)\nlag = '1 minute'\ninitialize = ON_CREATE\nwarehouse = DATA_HARMONIZATION_WH\nCOMMENT=TAGGING_COMMENT\nas\nSELECT NULL,TO_DATE(REPLACE(RECORD_DATA['start_date'],'\""','')), NULL, NULL, P.PLATFORM_ID,CAMPAIGNS.ACCOUNT_ID, CAMPAIGNS.CAMPAIGN_GROUP_ID,REPLACE(RECORD_DATA['campaign_id'],'\""','') AS CAMPAIGN_ID, NULL, NULL, CAMPAIGNS.CURRENCY, RECORD_DATA['impressions'],RECORD_DATA['clicks'], REPLACE(RECORD_DATA['costInLocalCurrency'],'\""',''), FROM DATABASE.SCHEMA.ad_analytics_by_campaign_daily CAMPAIGNS_DAILY LEFT JOIN ( SELECT APP_IDENTIFIER, REPLACE(RECORD_DATA['name'],'\""',''), SPLIT_PART(RECORD_DATA['campaignGroup'],':',4) AS CAMPAIGN_GROUP_ID, SPLIT_PART(RECORD_DATA['account'],':',4) AS ACCOUNT_ID, REPLACE(RECORD_DATA['dailyBudget']['currencyCode'],'\""','') AS CURRENCY FROM DATABASE.SCHEMA.campaigns ) CAMPAIGNS ON CAMPAIGNS.APP_IDENTIFIER = REPLACE(RECORD_DATA['campaign_id'],'\""','') LEFT JOIN CAMPAIGN_INTELLIGENCE_COMBINED.DIM_PLATFORM P ON P.PLATFORM_NAME = 'linkedin'""
             }
             }


}"